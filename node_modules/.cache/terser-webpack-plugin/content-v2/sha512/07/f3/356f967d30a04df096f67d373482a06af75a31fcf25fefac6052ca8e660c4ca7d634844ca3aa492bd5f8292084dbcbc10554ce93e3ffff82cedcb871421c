{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{640:function(e,t,s){\"use strict\";s.r(t),s.d(t,\"LoginView\",function(){return p});var i=s(0),a=s(3),r=s(4),l=s(2),n=s(8),o=s(179),d=s(14),c=s(62),u=s(177),h=s(95),m=s(1);let p=class extends m.Component{constructor(){super(...arguments),this.usernameFieldValue=\"\",this.passwordFieldValue=\"\",this.serverFieldValue=window.couchDBServer||r.u.get(\"server_location\")||location.origin.replace(/:\\d+$/g,\":5984\"),this.errorMessage=\"\",this.disableInputs=!1,this.step=1,this.editServerLocation=!1,this.initiallyChecked=!1}get impossibleToLogin(){return!navigator.onLine&&!r.u.found(\"LSL_hash\")}componentWillMount(){a.y.initialCheck(this.serverFieldValue).then(()=>this.initiallyChecked=!0)}render(){return m.createElement(\"div\",{className:\"login-component\"},this.impossibleToLogin?m.createElement(\"div\",{className:\"impossible\"},m.createElement(o.a,{messageBarType:d.a.error},\"You're offline and unable to login\",m.createElement(\"br\",null)),m.createElement(c.a,{text:\"Reload\",className:\"m-t-15 m-b-15\",onClick:()=>{location.reload()}})):m.createElement(\"div\",null,this.initiallyChecked?m.createElement(\"div\",{className:\"login-step\"},m.createElement(\"div\",{className:navigator.onLine?\"hidden\":\"\"},m.createElement(o.a,{messageBarType:d.a.warning},`${Object(a.z)(\"You're offline. Use the latest username/password you've successfully used on this machine to login to this server\")}:\\n\\t\\t\\t\\t\\t\\t\\t\\t${(this.serverFieldValue||\"\").replace(/([^\\/])\\/[^\\/].+/,\"$1\")}.\\n\\t\\t\\t\\t\\t\\t\\t`)),m.createElement(\"br\",null),m.createElement(\"hr\",null),m.createElement(\"div\",{className:navigator.onLine?\"\":\"hidden\"},m.createElement(\"div\",{style:{display:\"inline-block\",width:\"75%\"}},m.createElement(u.a,{name:\"server\",label:Object(a.z)(\"Server location\"),value:this.serverFieldValue,disabled:this.disableInputs||!this.editServerLocation,onChange:(e,t)=>this.serverFieldValue=t})),m.createElement(c.a,{className:\"edit-server-location\",onClick:()=>{this.editServerLocation=!0}},\"Change\")),m.createElement(\"br\",null),m.createElement(\"br\",null),m.createElement(\"hr\",null),m.createElement(u.a,{name:\"identification\",label:Object(a.z)(\"Username\"),disabled:this.disableInputs,value:this.usernameFieldValue,onChange:(e,t)=>this.usernameFieldValue=t}),m.createElement(u.a,{name:\"password\",type:\"Password\",label:Object(a.z)(\"Password\"),disabled:this.disableInputs,value:this.passwordFieldValue,onChange:(e,t)=>this.passwordFieldValue=t}),m.createElement(h.a,{text:Object(a.z)(\"Login\"),disabled:this.disableInputs,className:\"m-t-15 m-b-15\",onClick:()=>i.b(this,void 0,void 0,function*(){if(!(this.usernameFieldValue&&this.passwordFieldValue&&this.serverFieldValue))return void(this.errorMessage=\"All fields are necessary\");this.errorMessage=\"\";const e=yield a.y.loginWithCredentials({username:this.usernameFieldValue,password:this.passwordFieldValue,server:this.serverFieldValue.replace(/([^\\/])\\/[^\\/].+/,\"$1\")});\"boolean\"==typeof e&&!0===e||(this.errorMessage=e)})}),a.y.tryOffline?m.createElement(h.a,{text:Object(a.z)(\"Access offline\"),disabled:this.disableInputs,className:\"m-t-15 m-b-15 m-l-5 m-r-5\",onClick:()=>i.b(this,void 0,void 0,function*(){if(!(this.usernameFieldValue&&this.passwordFieldValue&&this.serverFieldValue))return void(this.errorMessage=\"All fields are necessary\");this.errorMessage=\"\";const e=yield a.y.loginWithCredentialsOffline({username:this.usernameFieldValue,password:this.passwordFieldValue,server:this.serverFieldValue.replace(/([^\\/])\\/[^\\/].+/,\"$1\")});\"boolean\"==typeof e&&!0===e||(this.errorMessage=e)})}):\"\",m.createElement(c.a,{onClick:()=>{a.y.startNoServer()},className:\"no-server-mode\"},\"no-server mode\")):\"\",this.errorMessage?m.createElement(o.a,{messageBarType:d.a.error},this.errorMessage):\"\"))}};i.c([l.k],p.prototype,\"usernameFieldValue\",void 0),i.c([l.k],p.prototype,\"passwordFieldValue\",void 0),i.c([l.k],p.prototype,\"serverFieldValue\",void 0),i.c([l.k],p.prototype,\"errorMessage\",void 0),i.c([l.k],p.prototype,\"disableInputs\",void 0),i.c([l.k],p.prototype,\"step\",void 0),i.c([l.k],p.prototype,\"editServerLocation\",void 0),i.c([l.k],p.prototype,\"initiallyChecked\",void 0),i.c([l.d],p.prototype,\"impossibleToLogin\",null),p=i.c([n.a],p)}}]);","extractedComments":[]}